CREATE DATABASE  SISTEMA_USUARIOS;
USE SISTEMA_USUARIOS;

CREATE TABLE USUARIOS (ID INT(4) AUTO_INCREMENT PRIMARY KEY, NOMBRE VARCHAR(100) NOT NULL, EMAIL VARCHAR(100) NOT NULL UNIQUE,

FECHA_REGISTRO DATETIME);


----------------
DELIMITER //

CREATE PROCEDURE INSERTAR_USUARIO(
                     IN P_NOMBRE VARCHAR(100),
                     IN p_EMAIL VARCHAR(100)
)

BEGIN
       DECLARE V_FECHA_ACTUAL DATE;
       SET V_FECHA_ACTUAL = CURDATE();

       IF(MONTH(V_FECHA_ACTUAL) = 7 AND DAY(V_FECHA_ACTUAL) BETWEEN 4 AND 7) THEN 
INSERT INTO USUARIOS (NOMBRE, EMAIL) 
VALUES (P_NOMBRE, P_EMAIL);
	ELSE
        SIGNAL SQLSTATE= '45000'
        SET MESSAGE_TEXT = "NO SE PUEDE REGISTRAR USUARIOS FUERA DE LA FECHA ESTABLECIDA";
        END IF;
  


END// 




DELIMITER ;


CALL INSERTAR_USUARIO("JUAN", "J@EMAIL.COM");


___________________________________________________________


DELIMITER //

CREATE PROCEDURE REGISTRAR_PERSONA(
                                 IN P_NOMBRE VARCHAR(100), 
				 in P_CIUDAD VARCHAR(100)   
                                  )
BEGIN
        IF UPPER(P_CIUDAD) IN ("BUENOS AIRES", "CORDOBA", "CÃ“RDOBA") THEN
INSERT INTO PERSONAS (NOMBRE, CIUDAD) 
VALUES (P_NOMBRE, P_CIUDAD);
ELSE 
SIGNAL SQLSTATE = "45000"
SET MESSAGE_TEXT = "SOLO SE PERMITEN PERSONAS DE BS AS Y CORDOBA";
END IF;
 

END//


DELIMITER ;

CALL REGISTRAR_PERSONA("ANA", "BUENOS AIRES");
CALL REGISTRAR_PERSONA("CARLOS", "CORDOBA");
CALL REGISTRAR_PERSONA("MARIO", "MENDOZA"); // da error personalizado

































